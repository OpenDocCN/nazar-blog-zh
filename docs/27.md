# 通过消息摘要检测病毒

> 原文：<http://web.archive.org/web/20220810161336/https://imrannazar.com/Virus-Detection-with-Message-Digests>

存储在计算机中的文件只是一串数字。例如，文本文件中的每个字母或数字都有一个数字；图形文件中的每种颜色元素都有一个数字。计算机程序也是文件:每个数字告诉计算机执行一个功能，如将两个数字相加，或将一个数字存储在另一个文件中。

问题是，因为程序就像其他文件一样是文件，它们可以被改变:修改某些数字，或者在文件中间添加新的流。这是病毒感染文件的一种方式；它们可能会添加到程序文件中，下次运行该程序时，病毒就会被执行并执行其设计的功能。

减轻这种情况的最好方法之一是使用一种称为“消息摘要”的技术:一个描述文件全部内容的数字。一个简单的例子是如下所示的算法:

如果字母表中的每个字母都被分配了一个数字，A 是 1，B 是 2，依此类推，就有可能把文本文件中的所有字母加在一起，得到一个“校验和”；文件内容的总和，可用于检查文件。举个例子，`HELLO WORLD`加起来就是 127。

这种最简单的消息摘要算法的一个问题是，空间可能被完全删除，而校验和是相同的；此外，只要所有字母的总数仍然是 127，就可以更改消息并添加更多内容。因此，已经开发了更复杂的算法来考虑这些问题。

当这些方法用于程序文件时，它们会生成一个数字，该数字对于该文件中的数字组合是唯一的。如果有任何变化，如指令被更改或被病毒添加，摘要号将会改变。

这可用于在每次程序运行时检测病毒。这个过程相对简单:当程序第一次安装时，会根据程序文件生成一个摘要。每次使用程序时，都要重新计算一次摘要，如果数字不同，则是某个外部代理更改了文件。

该系统最流行的实现之一是在 Windows 内部使用，称为文件保护；它用于对系统重要的文件，如设备驱动程序。如果 Windows 检测到其中一个文件的摘要不同于它所知道的摘要，用户将被警告系统文件已被更改。许多其他系统也在其他软件包中执行类似的功能。

文章日期:2006 年 9 月 22 日